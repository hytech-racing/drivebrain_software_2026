name: Build and publish image to Docker Hub
on: 
  push

jobs: 
  publish-image: 
    runs-on: ubuntu-latest
    steps: 
      - name: Checkout 
        uses: actions/checkout@v4
      
      - name: Build image
        run: docker build -t kkittur/drivebrain_cross_compile:latest .

      - name: push image to docker Hub
        run: | 
          docker push kkittur/drivebrain_cross_compile:latest

  build-executable: 
    runs-on: ubuntu-latest
    steps: 
      - name: Pull from container registry
        run: |
          docker pull kkittur/drivebrain_cross_compile:latest

      - name: Enter container 
        run: |  
          docker compose run dev

      - name: Build 
        run: |  
          ./build_script.sh
